    pp.llik <- function(data, X, mesh, L, beta, A, Aobs) # B, Bobs
    {
        ## ----------------------------------------------------------------
        ## input: data: list of Y and Ypos (list(Y, Ypos))
        ##        Y: data matrix of firing events
        ##        Ypos: data matrix of positional data
        ##        mesh: Delaunay triangulation of spatial domain
        ##              constructed using inla.mesh.2d from INLA package
        ##        L: vector of areas of line segments used for 
        ##           the approximation of the integral of the
        ##           void probability. 
        ##        beta: intercept of linear predictor
        ##        A: matrix of basis functions (psi_k(s_i))_{ik} evaluated        
        ##          at midpoints of line segments overline{s}_i
        ##        Aobs: matrix of basis functions (psi_k(s_i))_{ik}
        ##              evaluated at observed points s_i
        ## log likelihood of point process model.
        ## ----------------------------------------------------------------
        Ypos    <- data$Ypos
        Y       <- data$Y
        n            <- nrow(Y)
        p            <- nrow(X)
        tr.one.n     <- matrix(rep(1, n), nrow=1)
        beta         <- matrix(beta, ncol=1)
        X            <- matrix(X, ncol=1)
        ## 
        sumlogR      <- tr.one.n %*% (Aobs %*% X) + n * beta ## tr.one.n %*% Bobs %*% beta        
        ##
        integr       <- ((t(L)%*%(exp(A%*%X))))*as.numeric(exp(beta))## sum(exp(B%*%beta)))
        out          <- sumlogR - integr
        return(out)
    }
