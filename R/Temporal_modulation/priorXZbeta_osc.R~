prior.betaXZ_osc <- function(beta, X, Z, theta, mesh, mesh1d)
{
    ## ---------------------------------------
    ## input:
    ##       X: vector of parameters X
    ##       beta: vector of parameters X
    ##       spde: model object for oscillating Gaussian field created with inla.spde2
    ##       theta: hyperprior parameters
    ##       mesh: Delaunay triangulation of spatial domain constructed using inla.mesh.2d from INLA package
    ##             
    ## output:
    ##        prior log density of X, beta given theta
    ## ---------------------------------------
    theta.X <- theta[1:3]
    theta.Z <- theta[4:5]    
    QX     <- osc.precision(theta=theta.X, mesh=mesh)
    QZ     <- temp.precision(theta=theta.Z, mesh=mesh1d) 
    lpbeta <- dnorm(as.numeric(beta), mean=0, sd=1/sqrt(1e-6), log=TRUE)
    lpX    <- ldmvnorm(X, matrix(rep(0, length(X)), ncol=1), QX)
    lpZ    <- ldmvnorm(Z, matrix(rep(0, length(Z)), ncol=1), QZ)
    out    <- (lpbeta + lpX + lpZ )
    return(out)
}



